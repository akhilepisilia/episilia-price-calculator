<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title> Resonsive Pricing Table | CodingLab </title>
    <link rel="stylesheet" href="style.css">
    
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>

var warn_msg_count=0;
function price_cal(){
$.getJSON("new.json", function(data) {
    String.prototype.toTemplate=function(){
        return eval('`'+this+'`');
       
    }
    function changeStringToVariable(variable, value){
        eval(`${variable} = ${value} `);
        
    }
    function get_value(obj,search){
        return obj[search]["value"]
    
    }  
var c4=0,c5=0;c7=0,c8=0;
// value at inputs \

c4=document.getElementById("c4").value;
c5=c4*30;
c7=document.getElementById("c7").value;
c8=document.getElementById("c8").value;

console.log(c4,c5,c7,c8)

for(i in data){
    
    if (data[i]["type"]== "user_inputs"){
        
        if (i=="c4"){
            data[i]["value"] = c4;
        }
        if (i=="c5"){
          data[i]["value"] = c5;
      }
        if (i=="c7"){
            data[i]["value"] = c7;
        }
        if (i=="c8"){
            data[i]["value"] = c8;
        }

    }


}
var  avb_list=new Set(["c4","c5","c7","c8"])
order_list=["units","cost_calculations","Infra Cost (high-level)","Summary cost (Break up)","Episilia cost"]
for (order in order_list)
{
    for(i in data){
        if (data[i]["type"]== order_list[order]){
        if (data[i]["fixed"]== false){
            let input =data[i]["inputs"];
            console.log(data[i]["name"])
            for(j in input)
            {
               
                if (!(avb_list.has(input[j]))){
                    avb_list.add(input[j])
                    changeStringToVariable(input[j], get_value(data,input[j]));
                }  
            }
            let formula =data[i]["formula"]
            let temp_val=eval(formula.toTemplate())
            data[i]["value"]=Number(parseFloat(temp_val).toFixed(2))
            console.log(data[i]["value"])
            
        }
        }
    }  



}
if(warn_msg_count == 0){
console.warn("Warning :: Dont modify any of thies varibles values --",avb_list);
warn_msg_count=warn_msg_count+1;
}
show_order_list=["Episilia cost","Infra Cost (high-level)","Summary cost (Break up)"];

//console.log("Creating div cards");
var priceview = document.getElementById("priceview");
priceview.innerHTML="";
var card1 = document.createElement("div");
card1.className ="card one two"


var divdetails = document.createElement("div");
divdetails.className ="details";
for (order in show_order_list)
{
  if(show_order_list[order]=="Total Cost" )
  {
    continue
  }
  var info = document.createElement("div");
  if(show_order_list[order]=="Infra Cost (high-level)" || show_order_list[order]=="Summary cost (Break up)")
            {
              info.className ="info1 info2 ";//info2
            }
            else{
              info.className ="info1";
            }
 
if(show_order_list[order]=="Episilia cost")
{
  info.innerHTML ="Summary"
  Storage_logo = document.createElement("img");
  Storage_logo.className ="stroageLogo";
  Storage_logo.setAttribute("src","aws_logo1.png");
  info.appendChild(Storage_logo);
  
}

else{
  info.innerHTML =show_order_list[order];
}
  divdetails.appendChild(info);
  var price_content = document.createElement("div");
  if(show_order_list[order]=="Summary cost (Break up)")
  {
   // price_content.className ="panel";

  }
    for(i in data){
        if (data[i]["type"]== show_order_list[order] ){
          if( data[i]["display"]==true){
         
          var one = document.createElement('div');
            one.className ="one";
            var span1 = document.createElement("span");
            var span2 = document.createElement("span");
            span1.innerHTML = `${data[i]["name"]}`;
           if(data[i]["display_value_type"]=="cost"  )
            {
            let num =data[i]["value"]
            span2.innerHTML = `$ ${(Math.round(num * 100) / 100).toFixed(2)}`;
            }
            else{
              span2.innerHTML = `${data[i]["value"]}`;
            }
            span2.className ="value_sty";
            one.appendChild(span1);
            one.appendChild(span2);
            price_content.appendChild(one);
        }
      }
        divdetails.appendChild(price_content);
    }
    
  }
  
card1.appendChild(divdetails);


priceview.appendChild(card1);

//document.write(JSON.stringify(data))
// this will show the info it in firebug console
});
}
price_cal()
    </script>
   </head>

        
<body>
 

    <div class="content">
    
      <div class="card one">
        <div class="info">Price calculator</div>
        <div class="details" >
          <form onsubmit="price_cal();return false" >
          <div class="one">
            <span>Input Data(GB)- Daily:</span>
            <div class="col-3">
            <input type="number" id="c4" value=1000 name="c4" required>
            <span class="focus-border"></span>
            </div>
            
          </div>
          <div class="one">
            <span>Parallel Search:</span>
            <div class="col-3">
            <select type="number" id="c7" name="c7" >
              <option value=1>1</option>
              <option value=2>2</option>
              <option value=3>3</option>
              <option value=4>4</option>
              <option value=5>5</option>
              <option value=6>6</option>
              <option value=7>7</option>
              <option value=8>8</option>
              <option value=9>9</option>
              <option value=10 selected="selected" >10</option>
              <option value=11>11</option>
              <option value=12>12</option>
              <option value=13>13</option>
              <option value=14>14</option>
              <option value=15>15</option>
              <option value=16>16</option>
              <option value=17>17</option>
              <option value=18>18</option>
              <option value=19>19</option>
              <option value=20>20</option>
            </select>
            <span class="focus-border"></span>
          </div>
          </div>
          <div class="one">
            <span>Fixed Search Nodes:</span>
            <div class="col-3">
            <select type="number" id="c8" name="c8">
              <option value=1>1</option>
              <option value=2>2</option>
              <option value=3>3</option>
              <option value=4>4</option>
              <option value=5>5</option>
            </select>
            <span class="focus-border"></span>
            </div>
          </div>
          <button type="submit" class="submit" >Calculate</button>
        </form>

        </div>
         <button id="acc" class="accordion">Addition info</button>
          <div class="panel1">
            <div class="one">
              <span>s3 cost</span>
             
              <span class="value_sty" >$ 0.023</span>
              
              
            </div>

            <div class="one">
              <span>t3.medium	cost(ON-demand)</span>
             
              <span class="value_sty">$ 0.0416</span>
              
              
            </div>
          </div>
      </div>
    
     







      <div id="priceview">


        </div>

      
    </div>
<script>
var acc=document.getElementById("acc");
acc.addEventListener("click", function() {
    this.classList.toggle("active");
    var panel =  this.nextElementSibling;//document.getElementsByClassName("panel1");
    if (panel.style.maxHeight) {
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    } 
  });

    
    </script>
</body>
</html>
